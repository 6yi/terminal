parameters:
  configuration: 'Release'
  platform: ''
  additionalBuildArguments: ''

jobs:
- job: Build${{ parameters.platform }}${{ parameters.configuration }}
  displayName: Build ${{ parameters.platform }} ${{ parameters.configuration }}
  variables:
    BuildConfiguration: ${{ parameters.configuration }}
    BuildPlatform: ${{ parameters.platform }}
  pool: { vmImage: vs2017-win2016 }
  condition: ne(${{ parameters.configuration }}, "AuditMode")

  steps:
  - template: build-console-steps.yml
    parameters:
      additionalBuildArguments: ${{ parameters.additionalBuildArguments }}

- job: Build${{ parameters.platform }}AuditMode
  displayName: Build ${{ parameters.platform }} AuditMode
  variables:
    BuildConfiguration: ${{ parameters.configuration }}
    BuildPlatform: ${{ parameters.platform }}
  pool: { vmImage: vs2017-win2016 }
  condition: eq(${{ parameters.configuration }}, "AuditMode")

  steps:
  - template: build-console-audit-mode-steps.yml
    parameters:
      additionalBuildArguments: ${{ parameters.additionalBuildArguments }}
